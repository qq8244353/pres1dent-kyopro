<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="概要 # ぱっと見O(N^3)のDPが実はO(N^2)というやつ.
記事等 # https://snuke.hatenablog.com/entry/2019/01/15/211812 問題例 # https://atcoder.jp/contests/abc287/tasks/abc287_f
コード # int main() { ios::sync_with_stdio(false); std::cin.tie(nullptr); int n; cin >> n; vector to(n, vector<int>()); rep(i, n - 1) { int a, b; cin >> a >> b; a--, b--; to[a].push_back(b); to[b].push_back(a); } auto dfs = [&](auto&& self, int v, int p) -> vector<vector<mint>> { vector dp(2, vector<mint>(2)); dp[0][0] = 1, dp[1][1] = 1; for (auto u : to[v]) { if (u == p) { continue; } auto res = self(self, u, v); vector ndp(dp."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="二乗の木DP"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://qq8244353.github.io/pres1dent-kyopro/docs/nijounoki-dp/"><title>二乗の木DP | 競技プログラミング</title><link rel=manifest href=/pres1dent-kyopro/manifest.json><link rel=icon href=/pres1dent-kyopro/favicon.png type=image/x-icon><link rel=stylesheet href=/pres1dent-kyopro/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/pres1dent-kyopro/flexsearch.min.js></script>
<script defer src=/pres1dent-kyopro/en.search.min.25f3d6a5cde693906022f982bae2115607ab438955525f5d72bd13609af0938f.js integrity="sha256-JfPWpc3mk5BgIvmCuuIRVgerQ4lVUl9dcr0TYJrwk48=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=https://qq8244353.github.io/pres1dent-kyopro/docs/nijounoki-dp/index.xml title=競技プログラミング></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/pres1dent-kyopro/><span>競技プログラミング</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/pres1dent-kyopro/docs/kaisetuhoso/>Kaisetuhoso</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/euclidgojoho/>ユークリッドの互除法</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/nijounoki-dp/ class=active>二乗の木DP</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/nibuntansaku/>二分探索</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/syazojunisou/>写像12相</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/houjogenri/>包除原理</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/kukan-dp/>区間DP</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/fps/>形式的冪級数</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/keta-dp/>桁DP</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/chochoten/>超頂点</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/bubunretudp/>部分列DP</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/pres1dent-kyopro/svg/menu.svg class=book-icon alt=Menu></label>
<strong>二乗の木DP</strong>
<label for=toc-control><img src=/pres1dent-kyopro/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><h1 id=概要>概要
<a class=anchor href=#%e6%a6%82%e8%a6%81>#</a></h1><p>ぱっと見O(N^3)のDPが実はO(N^2)というやつ.</p><h1 id=記事等>記事等
<a class=anchor href=#%e8%a8%98%e4%ba%8b%e7%ad%89>#</a></h1><ul><li><a href=https://snuke.hatenablog.com/entry/2019/01/15/211812>https://snuke.hatenablog.com/entry/2019/01/15/211812</a></li></ul><h1 id=問題例>問題例
<a class=anchor href=#%e5%95%8f%e9%a1%8c%e4%be%8b>#</a></h1><p><a href=https://atcoder.jp/contests/abc287/tasks/abc287_f>https://atcoder.jp/contests/abc287/tasks/abc287_f</a></p><h1 id=コード>コード
<a class=anchor href=#%e3%82%b3%e3%83%bc%e3%83%89>#</a></h1><pre tabindex=0><code>int main() {
    ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    int n; cin &gt;&gt; n;
    vector to(n, vector&lt;int&gt;());
    rep(i, n - 1) {
        int a, b; cin &gt;&gt; a &gt;&gt; b;
        a--, b--;    
        to[a].push_back(b);
        to[b].push_back(a);
    }
    auto dfs = [&amp;](auto&amp;&amp; self, int v, int p) -&gt; vector&lt;vector&lt;mint&gt;&gt; {
        vector dp(2, vector&lt;mint&gt;(2));
        dp[0][0] = 1, dp[1][1] = 1;
        for (auto u : to[v]) {
            if (u == p) { continue; }
            auto res = self(self, u, v);
            vector ndp(dp.size() + res.size(), vector&lt;mint&gt;(2));
            rep(i, dp.size()) rep(j, res.size()) {
                if (i + j &gt;= ndp.size()) { break; }
                ndp[i + j][0] += dp[i][0] * (res[j][0] + res[j][1]);
                ndp[i + j][1] += dp[i][1] * res[j][0];
                if (i + j - 1 &gt;= 0) { ndp[i + j - 1][1] += dp[i][1] * res[j][1]; }
            }
            swap(ndp, dp);
        }
        return dp;
    };
    auto res = dfs(dfs, 0, -1);
    rep(i, n) {
        if (i + 1 &gt;= res.size()) { cout &lt;&lt; 0 &lt;&lt; endl; }
        else { cout &lt;&lt; (res[i + 1][0] + res[i + 1][1]).val() &lt;&lt; endl; }
    }
    return 0;
}
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents></nav></div></aside></main></body></html>