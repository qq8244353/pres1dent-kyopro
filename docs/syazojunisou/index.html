<!doctype html><html lang=ja dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" 写像12相 # n 個の区別する玉をk 個の区別しない箱に入れる場合の数（全ての箱に1つ以上）は第2種スターリング数として表されます. 第2種スターリング数は以下の二通りで求めることができます.
定義から # \[ S(n, k) = \frac{1}{k!}\sum_{i=1}^{k}(-1)^{k-i}{}_kC_ii^n \] 漸化式から # \[ S(n, k) = S(n - 1, k - 1) + k * S(n - 1, k) \] 漸化式で求めるライブラリ # struct stirling { stirling(i64 n) : v(n * (n + 1) / 2) { v[0] = 1; i64 l = 1; for (int i = 1; i < n; i++) { v[l] = 1; for (int j = 1; j < i; j++) { v[l + j] = v[l + j - i - 1] + (j + 1) * v[l + j - i]; } l += i + 1; v[l - 1] = 1; } } i64 get(i64 n, i64 k) const { if (k > n) { return 0; } return v[(n - 1) * n / 2 + k - 1]; } vector<i64> v; }; 第2種スターリング数表 # n\k 1 2 3 4 5 6 7 8 9 10 11 12 1 1 2 1 1 3 1 3 1 4 1 7 6 1 5 1 15 25 10 1 6 1 31 90 65 15 1 7 1 63 301 350 140 21 1 8 1 127 966 1701 1050 266 28 1 9 1 255 3025 7770 6951 2646 462 36 1 10 1 511 9330 34105 42525 22827 5880 750 45 1 11 1 1023 28501 145750 246730 179487 63987 11880 1155 55 1 12 1 2047 86526 611501 1379400 1323652 627396 159027 22275 1705 66 1 "><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="写像12相"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://qq8244353.github.io/pres1dent-kyopro/docs/syazojunisou/"><title>写像12相 | 競技プログラミング</title><link rel=manifest href=/pres1dent-kyopro/manifest.json><link rel=icon href=/pres1dent-kyopro/favicon.png type=image/x-icon><link rel=stylesheet href=/pres1dent-kyopro/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/pres1dent-kyopro/flexsearch.min.js></script>
<script defer src=/pres1dent-kyopro/en.search.min.62dacc794cb915cf43b541da7c7515e79cf7d2cad1230c02df823a501e70f008.js integrity="sha256-YtrMeUy5Fc9DtUHafHUV55z30srRIwwC34I6UB5w8Ag=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=https://qq8244353.github.io/pres1dent-kyopro/docs/syazojunisou/index.xml title=競技プログラミング></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/pres1dent-kyopro/><span>競技プログラミング</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/pres1dent-kyopro/docs/kaisetuhoso/>Kaisetuhoso</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/haskell/>haskellまとめ</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/xor-seisitu/>xorの性質</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/hanbunzenrekkyo/>セグ木</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/segki/>セグ木</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/euclidgojoho/>ユークリッドの互除法</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/syukyakutentou/>主客転倒</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/nijounoki-dp/>二乗の木DP</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/nibuntansaku/>二分探索</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/syazojunisou/ class=active>写像12相</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/houjogenri/>包除原理</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/kukan-dp/>区間DP</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/fps/>形式的冪級数</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/keta-dp/>桁DP</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/chochoten/>超頂点</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/tekisetunimaekeisan/>適切に前計算する</a><ul></ul></li><li><a href=/pres1dent-kyopro/docs/bubunretudp/>部分列DP</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/pres1dent-kyopro/svg/menu.svg class=book-icon alt=Menu></label>
<strong>写像12相</strong>
<label for=toc-control><img src=/pres1dent-kyopro/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#定義から>定義から</a></li><li><a href=#漸化式から>漸化式から</a></li><li><a href=#漸化式で求めるライブラリ>漸化式で求めるライブラリ</a></li><li><a href=#第2種スターリング数表>第2種スターリング数表</a></li></ul></nav></aside></header><article class=markdown><h1 id=写像12相>写像12相
<a class=anchor href=#%e5%86%99%e5%83%8f12%e7%9b%b8>#</a></h1><p>n 個の区別する玉をk 個の区別しない箱に入れる場合の数（全ての箱に1つ以上）は第2種スターリング数として表されます.
第2種スターリング数は以下の二通りで求めることができます.</p><h2 id=定義から>定義から
<a class=anchor href=#%e5%ae%9a%e7%be%a9%e3%81%8b%e3%82%89>#</a></h2><link rel=stylesheet href=/pres1dent-kyopro/katex/katex.min.css><script defer src=/pres1dent-kyopro/katex/katex.min.js></script>
<script defer src=/pres1dent-kyopro/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>
\[ S(n, k) = \frac{1}{k!}\sum_{i=1}^{k}(-1)^{k-i}{}_kC_ii^n \]</span><h2 id=漸化式から>漸化式から
<a class=anchor href=#%e6%bc%b8%e5%8c%96%e5%bc%8f%e3%81%8b%e3%82%89>#</a></h2><span>\[ S(n, k) = S(n - 1, k - 1) + k * S(n - 1, k) \]</span><h2 id=漸化式で求めるライブラリ>漸化式で求めるライブラリ
<a class=anchor href=#%e6%bc%b8%e5%8c%96%e5%bc%8f%e3%81%a7%e6%b1%82%e3%82%81%e3%82%8b%e3%83%a9%e3%82%a4%e3%83%96%e3%83%a9%e3%83%aa>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>stirling</span> {
</span></span><span style=display:flex><span>    stirling(i64 n) <span style=color:#f92672>:</span> v(n <span style=color:#f92672>*</span> (n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>        v[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        i64 l <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            v[l] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; j <span style=color:#f92672>&lt;</span> i; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                v[l <span style=color:#f92672>+</span> j] <span style=color:#f92672>=</span> v[l <span style=color:#f92672>+</span> j <span style=color:#f92672>-</span> i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> (j <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> v[l <span style=color:#f92672>+</span> j <span style=color:#f92672>-</span> i];
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            l <span style=color:#f92672>+=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            v[l <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    i64 <span style=color:#a6e22e>get</span>(i64 n, i64 k) <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (k <span style=color:#f92672>&gt;</span> n) { <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>; }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> v[(n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> n <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> k <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>i64<span style=color:#f92672>&gt;</span> v;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=第2種スターリング数表>第2種スターリング数表
<a class=anchor href=#%e7%ac%ac2%e7%a8%ae%e3%82%b9%e3%82%bf%e3%83%bc%e3%83%aa%e3%83%b3%e3%82%b0%e6%95%b0%e8%a1%a8>#</a></h2><table><thead><tr><th>n\k</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th></tr></thead><tbody><tr><td>1</td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>2</td><td>1</td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td>1</td><td>3</td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>4</td><td>1</td><td>7</td><td>6</td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>5</td><td>1</td><td>15</td><td>25</td><td>10</td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>6</td><td>1</td><td>31</td><td>90</td><td>65</td><td>15</td><td>1</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>7</td><td>1</td><td>63</td><td>301</td><td>350</td><td>140</td><td>21</td><td>1</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>8</td><td>1</td><td>127</td><td>966</td><td>1701</td><td>1050</td><td>266</td><td>28</td><td>1</td><td></td><td></td><td></td><td></td></tr><tr><td>9</td><td>1</td><td>255</td><td>3025</td><td>7770</td><td>6951</td><td>2646</td><td>462</td><td>36</td><td>1</td><td></td><td></td><td></td></tr><tr><td>10</td><td>1</td><td>511</td><td>9330</td><td>34105</td><td>42525</td><td>22827</td><td>5880</td><td>750</td><td>45</td><td>1</td><td></td><td></td></tr><tr><td>11</td><td>1</td><td>1023</td><td>28501</td><td>145750</td><td>246730</td><td>179487</td><td>63987</td><td>11880</td><td>1155</td><td>55</td><td>1</td><td></td></tr><tr><td>12</td><td>1</td><td>2047</td><td>86526</td><td>611501</td><td>1379400</td><td>1323652</td><td>627396</td><td>159027</td><td>22275</td><td>1705</td><td>66</td><td>1</td></tr></tbody></table></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#定義から>定義から</a></li><li><a href=#漸化式から>漸化式から</a></li><li><a href=#漸化式で求めるライブラリ>漸化式で求めるライブラリ</a></li><li><a href=#第2種スターリング数表>第2種スターリング数表</a></li></ul></nav></div></aside></main></body></html>